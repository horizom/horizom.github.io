(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{128:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=i.a.createContext({}),p=function(e){var t=i.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},b=function(e){var t=p(e.components);return i.a.createElement(c.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),b=p(n),u=a,d=b["".concat(o,".").concat(u)]||b[u]||h[u]||r;return n?i.a.createElement(d,s(s({ref:t},c),{},{components:n})):i.a.createElement(d,s({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<r;c++)o[c]=n[c];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},95:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return p}));var a=n(3),i=n(8),r=(n(0),n(128)),o={title:"Introduction"},s={unversionedId:"framework/auth/index",id:"framework/auth/index",isDocsHomePage:!1,title:"Introduction",description:"Authentication for PHP. Simple, lightweight and secure.",source:"@site/docs/framework/auth/index.md",sourceDirName:"framework/auth",slug:"/framework/auth/index",permalink:"/docs/framework/auth/index",editUrl:"https://github.com/horizom/docs/edit/master/docs/framework/auth/index.md",version:"current",frontMatter:{title:"Introduction"},sidebar:"framework",previous:{title:"Configuration",permalink:"/docs/framework/configuration"},next:{title:"Controller",permalink:"/docs/framework/basics/controller"}},l=[{value:"Requirements",id:"requirements",children:[]},{value:"Installation",id:"installation",children:[]},{value:"Usage",id:"usage",children:[{value:"Creating a new instance",id:"creating-a-new-instance",children:[]},{value:"Registration (sign up)",id:"registration-sign-up",children:[]},{value:"Login (sign in)",id:"login-sign-in",children:[]},{value:"Email verification",id:"email-verification",children:[]},{value:"Keeping the user logged in",id:"keeping-the-user-logged-in",children:[]},{value:"Password reset (\u201cforgot password\u201d)",id:"password-reset-forgot-password",children:[]},{value:"Changing the current user\u2019s password",id:"changing-the-current-users-password",children:[]},{value:"Changing the current user\u2019s email address",id:"changing-the-current-users-email-address",children:[]},{value:"Re-sending confirmation requests",id:"re-sending-confirmation-requests",children:[]},{value:"Logout",id:"logout",children:[]},{value:"Accessing user information",id:"accessing-user-information",children:[]},{value:"Reconfirming the user\u2019s password",id:"reconfirming-the-users-password",children:[]},{value:"Roles (or groups)",id:"roles-or-groups",children:[]},{value:"Enabling or disabling password resets",id:"enabling-or-disabling-password-resets",children:[]},{value:"Throttling or rate limiting",id:"throttling-or-rate-limiting",children:[]},{value:"Administration (managing users)",id:"administration-managing-users",children:[]},{value:"Cookies",id:"cookies",children:[]},{value:"Utilities",id:"utilities",children:[]},{value:"Reading and writing session data",id:"reading-and-writing-session-data",children:[]}]},{value:"Frequently asked questions",id:"frequently-asked-questions",children:[{value:"What about password hashing?",id:"what-about-password-hashing",children:[]},{value:"How can I implement custom password requirements?",id:"how-can-i-implement-custom-password-requirements",children:[]},{value:"Why are there problems when using other libraries that work with sessions?",id:"why-are-there-problems-when-using-other-libraries-that-work-with-sessions",children:[]},{value:"Why are other sites not able to frame or embed my site?",id:"why-are-other-sites-not-able-to-frame-or-embed-my-site",children:[]}]},{value:"Exceptions",id:"exceptions",children:[]},{value:"General advice",id:"general-advice",children:[]}],c={toc:l};function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Authentication for PHP. Simple, lightweight and secure.")),Object(r.b)("p",null,"Written once, to be used everywhere."),Object(r.b)("p",null,"Completely framework-agnostic and database-agnostic."),Object(r.b)("h2",{id:"requirements"},"Requirements"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"PHP 7.4.1+",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"PDO (PHP Data Objects) extension (",Object(r.b)("inlineCode",{parentName:"li"},"pdo"),")",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"MySQL Native Driver (",Object(r.b)("inlineCode",{parentName:"li"},"mysqlnd"),") ",Object(r.b)("strong",{parentName:"li"},"or")," PostgreSQL driver (",Object(r.b)("inlineCode",{parentName:"li"},"pgsql"),") ",Object(r.b)("strong",{parentName:"li"},"or")," SQLite driver (",Object(r.b)("inlineCode",{parentName:"li"},"sqlite"),")"))),Object(r.b)("li",{parentName:"ul"},"OpenSSL extension (",Object(r.b)("inlineCode",{parentName:"li"},"openssl"),")"))),Object(r.b)("li",{parentName:"ul"},"MySQL 5.5.3+ ",Object(r.b)("strong",{parentName:"li"},"or")," MariaDB 5.5.23+ ",Object(r.b)("strong",{parentName:"li"},"or")," PostgreSQL 9.5.10+ ",Object(r.b)("strong",{parentName:"li"},"or")," SQLite 3.14.1+ ",Object(r.b)("strong",{parentName:"li"},"or")," ",Object(r.b)("a",{parentName:"li",href:"Database"},"other SQL databases"))),Object(r.b)("h2",{id:"installation"},"Installation"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Include the library via Composer ",Object(r.b)("a",{parentName:"p",href:"https://github.com/delight-im/Knowledge/blob/master/Composer%20(PHP).md"},"[?]"),":"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-bash"},"composer require delight-im/auth\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Include the Composer autoloader:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"require __DIR__ . '/vendor/autoload.php';\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Set up a database and create the required tables:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"Database/MySQL.sql"},"MariaDB")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"Database/MySQL.sql"},"MySQL")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"Database/PostgreSQL.sql"},"PostgreSQL")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"Database/SQLite.sql"},"SQLite"))))),Object(r.b)("h2",{id:"usage"},"Usage"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#requirements"},"Requirements")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#installation"},"Installation")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#usage"},"Usage"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#creating-a-new-instance"},"Creating a new instance")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#registration-sign-up"},"Registration (sign up)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#login-sign-in"},"Login (sign in)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#email-verification"},"Email verification")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#keeping-the-user-logged-in"},"Keeping the user logged in")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#password-reset-forgot-password"},"Password reset (\u201cforgot password\u201d)"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#step-1-of-3-initiating-the-request"},"Step 1 of 3: Initiating the request")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#step-2-of-3-verifying-an-attempt"},"Step 2 of 3: Verifying an attempt")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#step-3-of-3-updating-the-password"},"Step 3 of 3: Updating the password")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#changing-the-current-users-password"},"Changing the current user\u2019s password")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#changing-the-current-users-email-address"},"Changing the current user\u2019s email address")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#re-sending-confirmation-requests"},"Re-sending confirmation requests")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#logout"},"Logout")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#accessing-user-information"},"Accessing user information"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#login-state"},"Login state")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#user-id"},"User ID")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#email-address"},"Email address")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#display-name"},"Display name")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#status-information"},"Status information")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#checking-whether-the-user-was-remembered"},"Checking whether the user was \u201cremembered\u201d")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#ip-address"},"IP address")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#additional-user-information"},"Additional user information")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#reconfirming-the-users-password"},"Reconfirming the user\u2019s password")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#roles-or-groups"},"Roles (or groups)"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#checking-roles"},"Checking roles")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#available-roles"},"Available roles")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#permissions-or-access-rights-privileges-or-capabilities"},"Permissions (or access rights, privileges or capabilities)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#custom-role-names"},"Custom role names")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#enabling-or-disabling-password-resets"},"Enabling or disabling password resets")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#throttling-or-rate-limiting"},"Throttling or rate limiting")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#administration-managing-users"},"Administration (managing users)"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#creating-new-users"},"Creating new users")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#deleting-users"},"Deleting users")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#retrieving-a-list-of-registered-users"},"Retrieving a list of registered users")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#assigning-roles-to-users"},"Assigning roles to users")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#taking-roles-away-from-users"},"Taking roles away from users")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#checking-roles-1"},"Checking roles")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#impersonating-users-logging-in-as-user"},"Impersonating users (logging in as user)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#changing-a-users-password"},"Changing a user\u2019s password")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#cookies"},"Cookies"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#renaming-the-librarys-cookies"},"Renaming the library\u2019s cookies")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#defining-the-domain-scope-for-cookies"},"Defining the domain scope for cookies")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#restricting-the-path-where-cookies-are-available"},"Restricting the path where cookies are available")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#controlling-client-side-script-access-to-cookies"},"Controlling client-side script access to cookies")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#configuring-transport-security-for-cookies"},"Configuring transport security for cookies")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#utilities"},"Utilities"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#creating-a-random-string"},"Creating a random string")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#creating-a-uuid-v4-as-per-rfc-4122"},"Creating a UUID v4 as per RFC 4122")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#reading-and-writing-session-data"},"Reading and writing session data")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#frequently-asked-questions"},"Frequently asked questions"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#what-about-password-hashing"},"What about password hashing?")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#how-can-i-implement-custom-password-requirements"},"How can I implement custom password requirements?")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#why-are-there-problems-when-using-other-libraries-that-work-with-sessions"},"Why are there problems when using other libraries that work with sessions?")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#why-are-other-sites-not-able-to-frame-or-embed-my-site"},"Why are other sites not able to frame or embed my site?")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#exceptions"},"Exceptions")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#general-advice"},"General advice"))),Object(r.b)("h3",{id:"creating-a-new-instance"},"Creating a new instance"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$db = new \\PDO('mysql:dbname=my-database;host=localhost;charset=utf8mb4', 'my-username', 'my-password');\n// or\n$db = new \\PDO('pgsql:dbname=my-database;host=localhost;port=5432', 'my-username', 'my-password');\n// or\n$db = new \\PDO('sqlite:../Databases/my-database.sqlite');\n\n$auth = new \\Horizom\\Auth\\Auth($db);\n")),Object(r.b)("p",null,"If you have an open ",Object(r.b)("inlineCode",{parentName:"p"},"PDO")," connection already, just re-use it. The database user (e.g. ",Object(r.b)("inlineCode",{parentName:"p"},"my-username"),") needs at least the privileges ",Object(r.b)("inlineCode",{parentName:"p"},"SELECT"),", ",Object(r.b)("inlineCode",{parentName:"p"},"INSERT"),", ",Object(r.b)("inlineCode",{parentName:"p"},"UPDATE")," and ",Object(r.b)("inlineCode",{parentName:"p"},"DELETE")," for the tables used by this library (or their parent database)."),Object(r.b)("p",null,"If your web server is behind a proxy server and ",Object(r.b)("inlineCode",{parentName:"p"},"$_SERVER['REMOTE_ADDR']")," only contains the proxy\u2019s IP address, you must pass the user\u2019s real IP address to the constructor in the second argument, which is named ",Object(r.b)("inlineCode",{parentName:"p"},"$ipAddress"),". The default is the usual remote IP address received by PHP."),Object(r.b)("p",null,"Should your database tables for this library need a common prefix, e.g. ",Object(r.b)("inlineCode",{parentName:"p"},"my_users")," instead of ",Object(r.b)("inlineCode",{parentName:"p"},"users")," (and likewise for the other tables), pass the prefix (e.g. ",Object(r.b)("inlineCode",{parentName:"p"},"my_"),") as the third parameter to the constructor, which is named ",Object(r.b)("inlineCode",{parentName:"p"},"$dbTablePrefix"),". This is optional and the prefix is empty by default."),Object(r.b)("p",null,"During development, you may want to disable the request limiting or throttling performed by this library. To do so, pass ",Object(r.b)("inlineCode",{parentName:"p"},"false")," to the constructor as the fourth argument, which is named ",Object(r.b)("inlineCode",{parentName:"p"},"$throttling"),". The feature is enabled by default."),Object(r.b)("p",null,"During the lifetime of a session, some user data may be changed remotely, either by a client in another session or by an administrator. That means this information must be regularly resynchronized with its authoritative source in the database, which this library does automatically. By default, this happens every five minutes. If you want to change this interval, pass a custom interval in seconds to the constructor as the fifth argument, which is named ",Object(r.b)("inlineCode",{parentName:"p"},"$sessionResyncInterval"),"."),Object(r.b)("p",null,"If all your database tables need a common database name, schema name, or other qualifier that must be specified explicitly, you can optionally pass that qualifier to the constructor as the sixth parameter, which is named ",Object(r.b)("inlineCode",{parentName:"p"},"$dbSchema"),"."),Object(r.b)("p",null,"If you want to use a ",Object(r.b)("inlineCode",{parentName:"p"},"PdoDatabase")," instance (e.g. ",Object(r.b)("inlineCode",{parentName:"p"},"$db"),") independently as well, please refer to the ",Object(r.b)("a",{parentName:"p",href:"https://github.com/delight-im/PHP-DB"},"documentation of the database library"),"."),Object(r.b)("h3",{id:"registration-sign-up"},"Registration (sign up)"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $userId = $auth->register($_POST['email'], $_POST['password'], $_POST['username'], function ($selector, $token) {\n        echo 'Send ' . $selector . ' and ' . $token . ' to the user (e.g. via email)';\n    });\n\n    echo 'We have signed up a new user with the ID ' . $userId;\n}\ncatch (\\Horizom\\Auth\\Exception\\InvalidEmailException $e) {\n    die('Invalid email address');\n}\ncatch (\\Horizom\\Auth\\Exception\\InvalidPasswordException $e) {\n    die('Invalid password');\n}\ncatch (\\Horizom\\Auth\\Exception\\UserAlreadyExistsException $e) {\n    die('User already exists');\n}\ncatch (\\Horizom\\Auth\\Exception\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," The anonymous callback function is a ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/functions.anonymous.php"},"closure"),". Thus, besides its own parameters, only ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/language.variables.superglobals.php"},"superglobals")," like ",Object(r.b)("inlineCode",{parentName:"p"},"$_GET"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_POST"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_COOKIE")," and ",Object(r.b)("inlineCode",{parentName:"p"},"$_SERVER")," are available inside. For any other variable from the parent scope, you need to explicitly make a copy available inside by adding a ",Object(r.b)("inlineCode",{parentName:"p"},"use")," clause after the parameter list."),Object(r.b)("p",null,"The username in the third parameter is optional. You can pass ",Object(r.b)("inlineCode",{parentName:"p"},"null")," there if you don\u2019t want to manage usernames."),Object(r.b)("p",null,"If you want to enforce unique usernames, on the other hand, simply call ",Object(r.b)("inlineCode",{parentName:"p"},"registerWithUniqueUsername")," instead of ",Object(r.b)("inlineCode",{parentName:"p"},"register"),", and be prepared to catch the ",Object(r.b)("inlineCode",{parentName:"p"},"DuplicateUsernameException"),"."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," When accepting and managing usernames, you may want to exclude non-printing control characters and certain printable special characters, as in the character class ",Object(r.b)("inlineCode",{parentName:"p"},"[\\x00-\\x1f\\x7f\\/:\\\\]"),". In order to do so, you could wrap the call to ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#register")," or ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#registerWithUniqueUsername")," inside a conditional branch, for example by only accepting usernames when the following condition is satisfied:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"if (\\preg_match('/[\\x00-\\x1f\\x7f\\/:\\\\\\\\]/', $username) === 0) {\n    // ...\n}\n")),Object(r.b)("p",null,"For email verification, you should build an URL with the selector and token and send it to the user, e.g.:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$url = 'https://www.example.com/verify_email?selector=' . \\urlencode($selector) . '&token=' . \\urlencode($token);\n")),Object(r.b)("p",null,"If you don\u2019t want to perform email verification, just omit the last parameter to ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#register"),". The new user will be active immediately, then."),Object(r.b)("p",null,"Need to store additional user information? Read on ",Object(r.b)("a",{parentName:"p",href:"#additional-user-information"},"here"),"."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," When sending an email to the user, please note that the (optional) username, at this point, has not yet been confirmed as acceptable to the owner of the (new) email address. It could contain offensive or misleading language chosen by someone who is not actually the owner of the address."),Object(r.b)("h3",{id:"login-sign-in"},"Login (sign in)"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->login($_POST['email'], $_POST['password']);\n\n    echo 'User is logged in';\n}\ncatch (\\Horizom\\Auth\\Exception\\InvalidEmailException $e) {\n    die('Wrong email address');\n}\ncatch (\\Horizom\\Auth\\Exception\\InvalidPasswordException $e) {\n    die('Wrong password');\n}\ncatch (\\Horizom\\Auth\\Exception\\EmailNotVerifiedException $e) {\n    die('Email not verified');\n}\ncatch (\\Horizom\\Auth\\Exception\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,"If you want to sign in with usernames on the other hand, either in addition to the login via email address or as a replacement, that\u2019s possible as well. Simply call the method ",Object(r.b)("inlineCode",{parentName:"p"},"loginWithUsername")," instead of method ",Object(r.b)("inlineCode",{parentName:"p"},"login"),". Then, instead of catching ",Object(r.b)("inlineCode",{parentName:"p"},"InvalidEmailException"),", make sure to catch both ",Object(r.b)("inlineCode",{parentName:"p"},"UnknownUsernameException")," and ",Object(r.b)("inlineCode",{parentName:"p"},"AmbiguousUsernameException"),". You may also want to read the notes about the uniqueness of usernames in the section that explains how to ",Object(r.b)("a",{parentName:"p",href:"#registration-sign-up"},"sign up new users"),"."),Object(r.b)("h3",{id:"email-verification"},"Email verification"),Object(r.b)("p",null,"Extract the selector and token from the URL that the user clicked on in the verification email."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->confirmEmail($_GET['selector'], $_GET['token']);\n\n    echo 'Email address has been verified';\n}\ncatch (\\Horizom\\Auth\\Exception\\InvalidSelectorTokenPairException $e) {\n    die('Invalid token');\n}\ncatch (\\Horizom\\Auth\\Exception\\TokenExpiredException $e) {\n    die('Token expired');\n}\ncatch (\\Horizom\\Auth\\Exception\\UserAlreadyExistsException $e) {\n    die('Email address already exists');\n}\ncatch (\\Horizom\\Auth\\Exception\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,"If you want the user to be automatically signed in after successful confirmation, just call ",Object(r.b)("inlineCode",{parentName:"p"},"confirmEmailAndSignIn")," instead of ",Object(r.b)("inlineCode",{parentName:"p"},"confirmEmail"),". That alternative method also supports ",Object(r.b)("a",{parentName:"p",href:"#keeping-the-user-logged-in"},"persistent logins")," via its optional third parameter."),Object(r.b)("p",null,"On success, the two methods ",Object(r.b)("inlineCode",{parentName:"p"},"confirmEmail")," and ",Object(r.b)("inlineCode",{parentName:"p"},"confirmEmailAndSignIn")," both return an array with the user\u2019s new email address, which has just been verified, at index one. If the confirmation was for an address change instead of a simple address verification, the user\u2019s old email address will be included in the array at index zero."),Object(r.b)("h3",{id:"keeping-the-user-logged-in"},"Keeping the user logged in"),Object(r.b)("p",null,"The third parameter to the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#login")," and ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#confirmEmailAndSignIn")," methods controls whether the login is persistent with a long-lived cookie. With such a persistent login, users may stay authenticated for a long time, even when the browser session has already been closed and the session cookies have expired. Typically, you\u2019ll want to keep the user logged in for weeks or months with this feature, which is known as \u201cremember me\u201d or \u201ckeep me logged in\u201d. Many users will find this more convenient, but it may be less secure if they leave their devices unattended."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"if ($_POST['remember'] == 1) {\n    // keep logged in for one year\n    $rememberDuration = (int) (60 * 60 * 24 * 365.25);\n}\nelse {\n    // do not keep logged in after session ends\n    $rememberDuration = null;\n}\n\n// ...\n\n$auth->login($_POST['email'], $_POST['password'], $rememberDuration);\n\n// ...\n")),Object(r.b)("p",null,Object(r.b)("em",{parentName:"p"},"Without")," the persistent login, which is the ",Object(r.b)("em",{parentName:"p"},"default")," behavior, a user will only stay logged in until they close their browser, or as long as configured via ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_lifetime")," and ",Object(r.b)("inlineCode",{parentName:"p"},"session.gc_maxlifetime")," in PHP."),Object(r.b)("p",null,"Omit the third parameter or set it to ",Object(r.b)("inlineCode",{parentName:"p"},"null")," to disable the feature. Otherwise, you may ask the user whether they want to enable \u201cremember me\u201d. This is usually done with a checkbox in your user interface. Use the input from that checkbox to decide between ",Object(r.b)("inlineCode",{parentName:"p"},"null")," and a pre-defined duration in seconds here, e.g. ",Object(r.b)("inlineCode",{parentName:"p"},"60 * 60 * 24 * 365.25")," for one year."),Object(r.b)("h3",{id:"password-reset-forgot-password"},"Password reset (\u201cforgot password\u201d)"),Object(r.b)("h4",{id:"step-1-of-3-initiating-the-request"},"Step 1 of 3: Initiating the request"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->forgotPassword($_POST['email'], function ($selector, $token) {\n        echo 'Send ' . $selector . ' and ' . $token . ' to the user (e.g. via email)';\n    });\n\n    echo 'Request has been generated';\n}\ncatch (\\Horizom\\Auth\\Exception\\InvalidEmailException $e) {\n    die('Invalid email address');\n}\ncatch (\\Horizom\\Auth\\Exception\\EmailNotVerifiedException $e) {\n    die('Email not verified');\n}\ncatch (\\Horizom\\Auth\\Exception\\ResetDisabledException $e) {\n    die('Password reset is disabled');\n}\ncatch (\\Horizom\\Auth\\Exception\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," The anonymous callback function is a ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/functions.anonymous.php"},"closure"),". Thus, besides its own parameters, only ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/language.variables.superglobals.php"},"superglobals")," like ",Object(r.b)("inlineCode",{parentName:"p"},"$_GET"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_POST"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_COOKIE")," and ",Object(r.b)("inlineCode",{parentName:"p"},"$_SERVER")," are available inside. For any other variable from the parent scope, you need to explicitly make a copy available inside by adding a ",Object(r.b)("inlineCode",{parentName:"p"},"use")," clause after the parameter list."),Object(r.b)("p",null,"You should build an URL with the selector and token and send it to the user, e.g.:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$url = 'https://www.example.com/reset_password?selector=' . \\urlencode($selector) . '&token=' . \\urlencode($token);\n")),Object(r.b)("p",null,"If the default lifetime of the password reset requests does not work for you, you can use the third parameter of ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#forgotPassword")," to specify a custom interval in seconds after which the requests should expire."),Object(r.b)("h4",{id:"step-2-of-3-verifying-an-attempt"},"Step 2 of 3: Verifying an attempt"),Object(r.b)("p",null,"As the next step, users will click on the link that they received. Extract the selector and token from the URL."),Object(r.b)("p",null,"If the selector/token pair is valid, let the user choose a new password:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->canResetPasswordOrThrow($_GET['selector'], $_GET['token']);\n\n    echo 'Put the selector into a \"hidden\" field (or keep it in the URL)';\n    echo 'Put the token into a \"hidden\" field (or keep it in the URL)';\n\n    echo 'Ask the user for their new password';\n}\ncatch (\\Horizom\\Auth\\Exception\\InvalidSelectorTokenPairException $e) {\n    die('Invalid token');\n}\ncatch (\\Horizom\\Auth\\Exception\\TokenExpiredException $e) {\n    die('Token expired');\n}\ncatch (\\Horizom\\Auth\\Exception\\ResetDisabledException $e) {\n    die('Password reset is disabled');\n}\ncatch (\\Horizom\\Auth\\Exception\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,"Alternatively, if you don\u2019t need any error messages but only want to check the validity, you can use the slightly simpler version:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"if ($auth->canResetPassword($_GET['selector'], $_GET['token'])) {\n    echo 'Put the selector into a \"hidden\" field (or keep it in the URL)';\n    echo 'Put the token into a \"hidden\" field (or keep it in the URL)';\n\n    echo 'Ask the user for their new password';\n}\n")),Object(r.b)("h4",{id:"step-3-of-3-updating-the-password"},"Step 3 of 3: Updating the password"),Object(r.b)("p",null,"Now when you have the new password for the user (and still have the other two pieces of information), you can reset the password:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->resetPassword($_POST['selector'], $_POST['token'], $_POST['password']);\n\n    echo 'Password has been reset';\n}\ncatch (\\Delight\\Auth\\InvalidSelectorTokenPairException $e) {\n    die('Invalid token');\n}\ncatch (\\Delight\\Auth\\TokenExpiredException $e) {\n    die('Token expired');\n}\ncatch (\\Delight\\Auth\\ResetDisabledException $e) {\n    die('Password reset is disabled');\n}\ncatch (\\Delight\\Auth\\InvalidPasswordException $e) {\n    die('Invalid password');\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,"Do you want to have the respective user signed in automatically when their password reset succeeds? Simply use ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#resetPasswordAndSignIn")," instead of ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#resetPassword")," to log in the user immediately."),Object(r.b)("p",null,"If you need the user\u2019s ID or email address, e.g. for sending them a notification that their password has successfully been reset, just use the return value of ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#resetPassword"),", which is an array containing two entries named ",Object(r.b)("inlineCode",{parentName:"p"},"id")," and ",Object(r.b)("inlineCode",{parentName:"p"},"email"),"."),Object(r.b)("h3",{id:"changing-the-current-users-password"},"Changing the current user\u2019s password"),Object(r.b)("p",null,"If a user is currently logged in, they may change their password."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->changePassword($_POST['oldPassword'], $_POST['newPassword']);\n\n    echo 'Password has been changed';\n}\ncatch (\\Delight\\Auth\\NotLoggedInException $e) {\n    die('Not logged in');\n}\ncatch (\\Delight\\Auth\\InvalidPasswordException $e) {\n    die('Invalid password(s)');\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,"Asking the user for their current (and soon ",Object(r.b)("em",{parentName:"p"},"old"),") password and requiring it for verification is the recommended way to handle password changes. This is shown above."),Object(r.b)("p",null,"If you\u2019re sure that you don\u2019t need that confirmation, however, you may call ",Object(r.b)("inlineCode",{parentName:"p"},"changePasswordWithoutOldPassword")," instead of ",Object(r.b)("inlineCode",{parentName:"p"},"changePassword")," and drop the first parameter from that method call (which would otherwise contain the old password)."),Object(r.b)("p",null,"In any case, after the user\u2019s password has been changed, you should send an email to their account\u2019s primary email address as an out-of-band notification informing the account owner about this critical change."),Object(r.b)("h3",{id:"changing-the-current-users-email-address"},"Changing the current user\u2019s email address"),Object(r.b)("p",null,"If a user is currently logged in, they may change their email address."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    if ($auth->reconfirmPassword($_POST['password'])) {\n        $auth->changeEmail($_POST['newEmail'], function ($selector, $token) {\n            echo 'Send ' . $selector . ' and ' . $token . ' to the user (e.g. via email to the *new* address)';\n        });\n\n        echo 'The change will take effect as soon as the new email address has been confirmed';\n    }\n    else {\n        echo 'We can\\'t say if the user is who they claim to be';\n    }\n}\ncatch (\\Delight\\Auth\\InvalidEmailException $e) {\n    die('Invalid email address');\n}\ncatch (\\Delight\\Auth\\UserAlreadyExistsException $e) {\n    die('Email address already exists');\n}\ncatch (\\Delight\\Auth\\EmailNotVerifiedException $e) {\n    die('Account not verified');\n}\ncatch (\\Delight\\Auth\\NotLoggedInException $e) {\n    die('Not logged in');\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," The anonymous callback function is a ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/functions.anonymous.php"},"closure"),". Thus, besides its own parameters, only ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/language.variables.superglobals.php"},"superglobals")," like ",Object(r.b)("inlineCode",{parentName:"p"},"$_GET"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_POST"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_COOKIE")," and ",Object(r.b)("inlineCode",{parentName:"p"},"$_SERVER")," are available inside. For any other variable from the parent scope, you need to explicitly make a copy available inside by adding a ",Object(r.b)("inlineCode",{parentName:"p"},"use")," clause after the parameter list."),Object(r.b)("p",null,"For email verification, you should build an URL with the selector and token and send it to the user, e.g.:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$url = 'https://www.example.com/verify_email?selector=' . \\urlencode($selector) . '&token=' . \\urlencode($token);\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," When sending an email to the user, please note that the (optional) username, at this point, has not yet been confirmed as acceptable to the owner of the (new) email address. It could contain offensive or misleading language chosen by someone who is not actually the owner of the address."),Object(r.b)("p",null,"After the request to change the email address has been made, or even better, after the change has been confirmed by the user, you should send an email to their account\u2019s ",Object(r.b)("em",{parentName:"p"},"previous")," email address as an out-of-band notification informing the account owner about this critical change."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," Changes to a user\u2019s email address take effect in the local session immediately, as expected. In other sessions (e.g. on other devices), the changes may need up to five minutes to take effect, though. This increases performance and usually poses no problem. If you want to change this behavior, nevertheless, simply decrease (or perhaps increase) the value that you pass to the ",Object(r.b)("a",{parentName:"p",href:"#creating-a-new-instance"},Object(r.b)("inlineCode",{parentName:"a"},"Auth")," constructor")," as the argument named ",Object(r.b)("inlineCode",{parentName:"p"},"$sessionResyncInterval"),"."),Object(r.b)("h3",{id:"re-sending-confirmation-requests"},"Re-sending confirmation requests"),Object(r.b)("p",null,"If an earlier confirmation request could not be delivered to the user, or if the user missed that request, or if they just don\u2019t want to wait any longer, you may re-send an earlier request like this:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->resendConfirmationForEmail($_POST['email'], function ($selector, $token) {\n        echo 'Send ' . $selector . ' and ' . $token . ' to the user (e.g. via email)';\n    });\n\n    echo 'The user may now respond to the confirmation request (usually by clicking a link)';\n}\ncatch (\\Delight\\Auth\\ConfirmationRequestNotFound $e) {\n    die('No earlier request found that could be re-sent');\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    die('There have been too many requests -- try again later');\n}\n")),Object(r.b)("p",null,"If you want to specify the user by their ID instead of by their email address, this is possible as well:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->resendConfirmationForUserId($_POST['userId'], function ($selector, $token) {\n        echo 'Send ' . $selector . ' and ' . $token . ' to the user (e.g. via email)';\n    });\n\n    echo 'The user may now respond to the confirmation request (usually by clicking a link)';\n}\ncatch (\\Delight\\Auth\\ConfirmationRequestNotFound $e) {\n    die('No earlier request found that could be re-sent');\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    die('There have been too many requests -- try again later');\n}\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," The anonymous callback function is a ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/functions.anonymous.php"},"closure"),". Thus, besides its own parameters, only ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/language.variables.superglobals.php"},"superglobals")," like ",Object(r.b)("inlineCode",{parentName:"p"},"$_GET"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_POST"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$_COOKIE")," and ",Object(r.b)("inlineCode",{parentName:"p"},"$_SERVER")," are available inside. For any other variable from the parent scope, you need to explicitly make a copy available inside by adding a ",Object(r.b)("inlineCode",{parentName:"p"},"use")," clause after the parameter list."),Object(r.b)("p",null,"Usually, you should build an URL with the selector and token and send it to the user, e.g. as follows:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$url = 'https://www.example.com/verify_email?selector=' . \\urlencode($selector) . '&token=' . \\urlencode($token);\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," When sending an email to the user, please note that the (optional) username, at this point, has not yet been confirmed as acceptable to the owner of the (new) email address. It could contain offensive or misleading language chosen by someone who is not actually the owner of the address."),Object(r.b)("h3",{id:"logout"},"Logout"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$auth->logOut();\n\n// or\n\ntry {\n    $auth->logOutEverywhereElse();\n}\ncatch (\\Delight\\Auth\\NotLoggedInException $e) {\n    die('Not logged in');\n}\n\n// or\n\ntry {\n    $auth->logOutEverywhere();\n}\ncatch (\\Delight\\Auth\\NotLoggedInException $e) {\n    die('Not logged in');\n}\n")),Object(r.b)("p",null,"Additionally, if you store custom information in the session as well, and if you want that information to be deleted, you can destroy the entire session by calling a second method:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$auth->destroySession();\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," Global logouts take effect in the local session immediately, as expected. In other sessions (e.g. on other devices), the changes may need up to five minutes to take effect, though. This increases performance and usually poses no problem. If you want to change this behavior, nevertheless, simply decrease (or perhaps increase) the value that you pass to the ",Object(r.b)("a",{parentName:"p",href:"#creating-a-new-instance"},Object(r.b)("inlineCode",{parentName:"a"},"Auth")," constructor")," as the argument named ",Object(r.b)("inlineCode",{parentName:"p"},"$sessionResyncInterval"),"."),Object(r.b)("h3",{id:"accessing-user-information"},"Accessing user information"),Object(r.b)("h4",{id:"login-state"},"Login state"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"if ($auth->isLoggedIn()) {\n    echo 'User is signed in';\n}\nelse {\n    echo 'User is not signed in yet';\n}\n")),Object(r.b)("p",null,"A shorthand/alias for this method is ",Object(r.b)("inlineCode",{parentName:"p"},"$auth->check()"),"."),Object(r.b)("h4",{id:"user-id"},"User ID"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$id = $auth->getUserId();\n")),Object(r.b)("p",null,"If the user is not currently signed in, this returns ",Object(r.b)("inlineCode",{parentName:"p"},"null"),"."),Object(r.b)("p",null,"A shorthand/alias for this method is ",Object(r.b)("inlineCode",{parentName:"p"},"$auth->id()"),"."),Object(r.b)("h4",{id:"email-address"},"Email address"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$email = $auth->getEmail();\n")),Object(r.b)("p",null,"If the user is not currently signed in, this returns ",Object(r.b)("inlineCode",{parentName:"p"},"null"),"."),Object(r.b)("h4",{id:"display-name"},"Display name"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$username = $auth->getUsername();\n")),Object(r.b)("p",null,"Remember that usernames are optional and there is only a username if you supplied it during registration."),Object(r.b)("p",null,"If the user is not currently signed in, this returns ",Object(r.b)("inlineCode",{parentName:"p"},"null"),"."),Object(r.b)("h4",{id:"status-information"},"Status information"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"if ($auth->isNormal()) {\n    echo 'User is in default state';\n}\n\nif ($auth->isArchived()) {\n    echo 'User has been archived';\n}\n\nif ($auth->isBanned()) {\n    echo 'User has been banned';\n}\n\nif ($auth->isLocked()) {\n    echo 'User has been locked';\n}\n\nif ($auth->isPendingReview()) {\n    echo 'User is pending review';\n}\n\nif ($auth->isSuspended()) {\n    echo 'User has been suspended';\n}\n")),Object(r.b)("h4",{id:"checking-whether-the-user-was-remembered"},"Checking whether the user was \u201cremembered\u201d"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"if ($auth->isRemembered()) {\n    echo 'User did not sign in but was logged in through their long-lived cookie';\n}\nelse {\n    echo 'User signed in manually';\n}\n")),Object(r.b)("p",null,"If the user is not currently signed in, this returns ",Object(r.b)("inlineCode",{parentName:"p"},"null"),"."),Object(r.b)("h4",{id:"ip-address"},"IP address"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$ip = $auth->getIpAddress();\n")),Object(r.b)("h4",{id:"additional-user-information"},"Additional user information"),Object(r.b)("p",null,"In order to preserve this library\u2019s suitability for all purposes as well as its full re-usability, it doesn\u2019t come with additional bundled columns for user information. But you don\u2019t have to do without additional user information, of course:"),Object(r.b)("p",null,"Here\u2019s how to use this library with your own tables for custom user information in a maintainable and re-usable way:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Add any number of custom database tables where you store custom user information, e.g. a table named ",Object(r.b)("inlineCode",{parentName:"p"},"profiles"),".")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Whenever you call the ",Object(r.b)("inlineCode",{parentName:"p"},"register")," method (which returns the new user\u2019s ID), add your own logic afterwards that fills your custom database tables.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"If you need the custom user information only rarely, you may just retrieve it as needed. If you need it more frequently, however, you\u2019d probably want to have it in your session data. The following method is how you can load and access your data in a reliable way:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"function getUserInfo(\\Delight\\Auth\\Auth $auth) {\n    if (!$auth->isLoggedIn()) {\n        return null;\n    }\n\n    if (!isset($_SESSION['_internal_user_info'])) {\n        // TODO: load your custom user information and assign it to the session variable below\n        // $_SESSION['_internal_user_info'] = ...\n    }\n\n    return $_SESSION['_internal_user_info'];\n}\n")))),Object(r.b)("h3",{id:"reconfirming-the-users-password"},"Reconfirming the user\u2019s password"),Object(r.b)("p",null,"Whenever you want to confirm the user\u2019s identity again, e.g. before the user is allowed to perform some \u201cdangerous\u201d action, you should verify their password again to confirm that they actually are who they claim to be."),Object(r.b)("p",null,"For example, when a user has been remembered by a long-lived cookie and thus ",Object(r.b)("inlineCode",{parentName:"p"},"Auth#isRemembered")," returns ",Object(r.b)("inlineCode",{parentName:"p"},"true"),", this means that the user probably has not entered their password for quite some time anymore. You may want to reconfirm their password in that case."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    if ($auth->reconfirmPassword($_POST['password'])) {\n        echo 'The user really seems to be who they claim to be';\n    }\n    else {\n        echo 'We can\\'t say if the user is who they claim to be';\n    }\n}\ncatch (\\Delight\\Auth\\NotLoggedInException $e) {\n    die('The user is not signed in');\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("h3",{id:"roles-or-groups"},"Roles (or groups)"),Object(r.b)("p",null,"Every user can have any number of roles, which you can use to implement authorization and to refine your access controls."),Object(r.b)("p",null,"Users may have no role at all (which they do by default), exactly one role, or any arbitrary combination of roles."),Object(r.b)("h4",{id:"checking-roles"},"Checking roles"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"if ($auth->hasRole(\\Delight\\Auth\\Role::SUPER_MODERATOR)) {\n    echo 'The user is a super moderator';\n}\n\n// or\n\nif ($auth->hasAnyRole(\\Delight\\Auth\\Role::DEVELOPER, \\Delight\\Auth\\Role::MANAGER)) {\n    echo 'The user is either a developer, or a manager, or both';\n}\n\n// or\n\nif ($auth->hasAllRoles(\\Delight\\Auth\\Role::DEVELOPER, \\Delight\\Auth\\Role::MANAGER)) {\n    echo 'The user is both a developer and a manager';\n}\n")),Object(r.b)("p",null,"While the method ",Object(r.b)("inlineCode",{parentName:"p"},"hasRole")," takes exactly one role as its argument, the two methods ",Object(r.b)("inlineCode",{parentName:"p"},"hasAnyRole")," and ",Object(r.b)("inlineCode",{parentName:"p"},"hasAllRoles")," can take any number of roles that you would like to check for."),Object(r.b)("p",null,"Alternatively, you can get a list of all the roles that have been assigned to the user:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$auth->getRoles();\n")),Object(r.b)("h4",{id:"available-roles"},"Available roles"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\Delight\\Auth\\Role::ADMIN;\n\\Delight\\Auth\\Role::AUTHOR;\n\\Delight\\Auth\\Role::COLLABORATOR;\n\\Delight\\Auth\\Role::CONSULTANT;\n\\Delight\\Auth\\Role::CONSUMER;\n\\Delight\\Auth\\Role::CONTRIBUTOR;\n\\Delight\\Auth\\Role::COORDINATOR;\n\\Delight\\Auth\\Role::CREATOR;\n\\Delight\\Auth\\Role::DEVELOPER;\n\\Delight\\Auth\\Role::DIRECTOR;\n\\Delight\\Auth\\Role::EDITOR;\n\\Delight\\Auth\\Role::EMPLOYEE;\n\\Delight\\Auth\\Role::MAINTAINER;\n\\Delight\\Auth\\Role::MANAGER;\n\\Delight\\Auth\\Role::MODERATOR;\n\\Delight\\Auth\\Role::PUBLISHER;\n\\Delight\\Auth\\Role::REVIEWER;\n\\Delight\\Auth\\Role::SUBSCRIBER;\n\\Delight\\Auth\\Role::SUPER_ADMIN;\n\\Delight\\Auth\\Role::SUPER_EDITOR;\n\\Delight\\Auth\\Role::SUPER_MODERATOR;\n\\Delight\\Auth\\Role::TRANSLATOR;\n")),Object(r.b)("p",null,"You can use any of these roles and ignore those that you don\u2019t need. The list above can also be retrieved programmatically, in one of three formats:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\Delight\\Auth\\Role::getMap();\n// or\n\\Delight\\Auth\\Role::getNames();\n// or\n\\Delight\\Auth\\Role::getValues();\n")),Object(r.b)("h4",{id:"permissions-or-access-rights-privileges-or-capabilities"},"Permissions (or access rights, privileges or capabilities)"),Object(r.b)("p",null,"The permissions of each user are encoded in the way that role requirements are specified throughout your code base. If those requirements are evaluated with a specific user\u2019s set of roles, implicitly checked permissions are the result."),Object(r.b)("p",null,"For larger projects, it is often recommended to maintain the definition of permissions in a single place. You then don\u2019t check for ",Object(r.b)("em",{parentName:"p"},"roles")," in your business logic, but you check for ",Object(r.b)("em",{parentName:"p"},"individual permissions"),". You could implement that concept as follows:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"function canEditArticle(\\Delight\\Auth\\Auth $auth) {\n    return $auth->hasAnyRole(\n        \\Delight\\Auth\\Role::MODERATOR,\n        \\Delight\\Auth\\Role::SUPER_MODERATOR,\n        \\Delight\\Auth\\Role::ADMIN,\n        \\Delight\\Auth\\Role::SUPER_ADMIN\n    );\n}\n\n// ...\n\nif (canEditArticle($auth)) {\n    echo 'The user can edit articles here';\n}\n\n// ...\n\nif (canEditArticle($auth)) {\n    echo '... and here';\n}\n\n// ...\n\nif (canEditArticle($auth)) {\n    echo '... and here';\n}\n")),Object(r.b)("p",null,"As you can see, the permission of whether a certain user can edit an article is stored at a central location. This implementation has two major advantages:"),Object(r.b)("p",null,"If you ",Object(r.b)("em",{parentName:"p"},"want to know")," which users can edit articles, you don\u2019t have to check your business logic in various places, but you only have to look where the specific permission is defined. And if you want to ",Object(r.b)("em",{parentName:"p"},"change")," who can edit an article, you only have to do this in one single place as well, not throughout your whole code base."),Object(r.b)("p",null,"But this also comes with slightly more overhead when implementing the access restrictions for the first time, which may or may not be worth it for your project."),Object(r.b)("h4",{id:"custom-role-names"},"Custom role names"),Object(r.b)("p",null,"If the names of the included roles don\u2019t work for you, you can alias any number of roles using your own identifiers, e.g. like this:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"namespace My\\Namespace;\n\nfinal class MyRole {\n\n    const CUSTOMER_SERVICE_AGENT = \\Delight\\Auth\\Role::REVIEWER;\n    const FINANCIAL_DIRECTOR = \\Delight\\Auth\\Role::COORDINATOR;\n\n    private function __construct() {}\n\n}\n")),Object(r.b)("p",null,"The example above would allow you to use"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\My\\Namespace\\MyRole::CUSTOMER_SERVICE_AGENT;\n// and\n\\My\\Namespace\\MyRole::FINANCIAL_DIRECTOR;\n")),Object(r.b)("p",null,"instead of"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\Delight\\Auth\\Role::REVIEWER;\n// and\n\\Delight\\Auth\\Role::COORDINATOR;\n")),Object(r.b)("p",null,"Just remember ",Object(r.b)("em",{parentName:"p"},"not")," to alias a ",Object(r.b)("em",{parentName:"p"},"single")," included role to ",Object(r.b)("em",{parentName:"p"},"multiple")," roles with custom names."),Object(r.b)("h3",{id:"enabling-or-disabling-password-resets"},"Enabling or disabling password resets"),Object(r.b)("p",null,"While password resets via email are a convenient feature that most users find helpful from time to time, the availability of this feature implies that accounts on your service are only ever as secure as the user\u2019s associated email account."),Object(r.b)("p",null,"You may provide security-conscious (and experienced) users with the possibility to disable password resets for their accounts (and to enable them again later) for enhanced security:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    if ($auth->reconfirmPassword($_POST['password'])) {\n        $auth->setPasswordResetEnabled($_POST['enabled'] == 1);\n\n        echo 'The setting has been changed';\n    }\n    else {\n        echo 'We can\\'t say if the user is who they claim to be';\n    }\n}\ncatch (\\Delight\\Auth\\NotLoggedInException $e) {\n    die('The user is not signed in');\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    die('Too many requests');\n}\n")),Object(r.b)("p",null,"In order to check the current value of this setting, use the return value from"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$auth->isPasswordResetEnabled();\n")),Object(r.b)("p",null,"for the correct default option in your user interface. You don\u2019t need to check this value for restrictions of the feature, which are enforced automatically."),Object(r.b)("h3",{id:"throttling-or-rate-limiting"},"Throttling or rate limiting"),Object(r.b)("p",null,"All methods provided by this library are ",Object(r.b)("em",{parentName:"p"},"automatically")," protected against excessive numbers of requests from clients. If the need arises, you can (temporarily) disable this protection using the ",Object(r.b)("a",{parentName:"p",href:"#creating-a-new-instance"},Object(r.b)("inlineCode",{parentName:"a"},"$throttling")," parameter")," passed to the constructor."),Object(r.b)("p",null,"If you would like to throttle or rate limit ",Object(r.b)("em",{parentName:"p"},"external")," features or methods as well, e.g. those in your own code, you can make use of the built-in helper method for throttling and rate limiting:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    // throttle the specified resource or feature to *3* requests per *60* seconds\n    $auth->throttle([ 'my-resource-name' ], 3, 60);\n\n    echo 'Do something with the resource or feature';\n}\ncatch (\\Delight\\Auth\\TooManyRequestsException $e) {\n    // operation cancelled\n\n    \\http_response_code(429);\n    exit;\n}\n")),Object(r.b)("p",null,"If the protection of the resource or feature should additionally depend on another attribute, e.g. to track something separately per IP address, just add more data to the resource description, such as:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"[ 'my-resource-name', $_SERVER['REMOTE_ADDR'] ]\n// instead of\n// [ 'my-resource-name' ]\n")),Object(r.b)("p",null,"Allowing short bursts of activity during peak demand is possible by specifying a burst factor as the fourth argument. A value of ",Object(r.b)("inlineCode",{parentName:"p"},"5"),", for example, would permit temporary bursts of fivefold activity, compared to the generally accepted level."),Object(r.b)("p",null,"In some cases, you may just want to ",Object(r.b)("em",{parentName:"p"},"simulate")," the throttling or rate limiting. This lets you check whether an action would be permitted without actually modifying the activity tracker. To do so, simply pass ",Object(r.b)("inlineCode",{parentName:"p"},"true")," as the fifth argument."),Object(r.b)("h3",{id:"administration-managing-users"},"Administration (managing users)"),Object(r.b)("p",null,"The administrative interface is available via ",Object(r.b)("inlineCode",{parentName:"p"},"$auth->admin()"),". You can call various method on this interface, as documented below."),Object(r.b)("p",null,"Do not forget to implement secure access control before exposing access to this interface. For example, you may provide access to this interface to logged in users with the administrator role only, or use the interface in private scripts only."),Object(r.b)("h4",{id:"creating-new-users"},"Creating new users"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $userId = $auth->admin()->createUser($_POST['email'], $_POST['password'], $_POST['username']);\n\n    echo 'We have signed up a new user with the ID ' . $userId;\n}\ncatch (\\Delight\\Auth\\InvalidEmailException $e) {\n    die('Invalid email address');\n}\ncatch (\\Delight\\Auth\\InvalidPasswordException $e) {\n    die('Invalid password');\n}\ncatch (\\Delight\\Auth\\UserAlreadyExistsException $e) {\n    die('User already exists');\n}\n")),Object(r.b)("p",null,"The username in the third parameter is optional. You can pass ",Object(r.b)("inlineCode",{parentName:"p"},"null")," there if you don\u2019t want to manage usernames."),Object(r.b)("p",null,"If you want to enforce unique usernames, on the other hand, simply call ",Object(r.b)("inlineCode",{parentName:"p"},"createUserWithUniqueUsername")," instead of ",Object(r.b)("inlineCode",{parentName:"p"},"createUser"),", and be prepared to catch the ",Object(r.b)("inlineCode",{parentName:"p"},"DuplicateUsernameException"),"."),Object(r.b)("h4",{id:"deleting-users"},"Deleting users"),Object(r.b)("p",null,"Deleting users by their ID:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->admin()->deleteUserById($_POST['id']);\n}\ncatch (\\Delight\\Auth\\UnknownIdException $e) {\n    die('Unknown ID');\n}\n")),Object(r.b)("p",null,"Deleting users by their email address:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->admin()->deleteUserByEmail($_POST['email']);\n}\ncatch (\\Delight\\Auth\\InvalidEmailException $e) {\n    die('Unknown email address');\n}\n")),Object(r.b)("p",null,"Deleting users by their username:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->admin()->deleteUserByUsername($_POST['username']);\n}\ncatch (\\Delight\\Auth\\UnknownUsernameException $e) {\n    die('Unknown username');\n}\ncatch (\\Delight\\Auth\\AmbiguousUsernameException $e) {\n    die('Ambiguous username');\n}\n")),Object(r.b)("h4",{id:"retrieving-a-list-of-registered-users"},"Retrieving a list of registered users"),Object(r.b)("p",null,"When fetching a list of all users, the requirements vary greatly between projects and use cases, and customization is common. For example, you might want to fetch different columns, join related tables, filter by certain criteria, change how results are sorted (in varying direction), and limit the number of results (while providing an offset)."),Object(r.b)("p",null,"That\u2019s why it\u2019s easier to use a single custom SQL query. Start with the following:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-sql"},"SELECT id, email, username, status, verified, roles_mask, registered, last_login FROM users;\n")),Object(r.b)("h4",{id:"assigning-roles-to-users"},"Assigning roles to users"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->admin()->addRoleForUserById($userId, \\Delight\\Auth\\Role::ADMIN);\n}\ncatch (\\Delight\\Auth\\UnknownIdException $e) {\n    die('Unknown user ID');\n}\n\n// or\n\ntry {\n    $auth->admin()->addRoleForUserByEmail($userEmail, \\Delight\\Auth\\Role::ADMIN);\n}\ncatch (\\Delight\\Auth\\InvalidEmailException $e) {\n    die('Unknown email address');\n}\n\n// or\n\ntry {\n    $auth->admin()->addRoleForUserByUsername($username, \\Delight\\Auth\\Role::ADMIN);\n}\ncatch (\\Delight\\Auth\\UnknownUsernameException $e) {\n    die('Unknown username');\n}\ncatch (\\Delight\\Auth\\AmbiguousUsernameException $e) {\n    die('Ambiguous username');\n}\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," Changes to a user\u2019s set of roles may need up to five minutes to take effect. This increases performance and usually poses no problem. If you want to change this behavior, nevertheless, simply decrease (or perhaps increase) the value that you pass to the ",Object(r.b)("a",{parentName:"p",href:"#creating-a-new-instance"},Object(r.b)("inlineCode",{parentName:"a"},"Auth")," constructor")," as the argument named ",Object(r.b)("inlineCode",{parentName:"p"},"$sessionResyncInterval"),"."),Object(r.b)("h4",{id:"taking-roles-away-from-users"},"Taking roles away from users"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->admin()->removeRoleForUserById($userId, \\Delight\\Auth\\Role::ADMIN);\n}\ncatch (\\Delight\\Auth\\UnknownIdException $e) {\n    die('Unknown user ID');\n}\n\n// or\n\ntry {\n    $auth->admin()->removeRoleForUserByEmail($userEmail, \\Delight\\Auth\\Role::ADMIN);\n}\ncatch (\\Delight\\Auth\\InvalidEmailException $e) {\n    die('Unknown email address');\n}\n\n// or\n\ntry {\n    $auth->admin()->removeRoleForUserByUsername($username, \\Delight\\Auth\\Role::ADMIN);\n}\ncatch (\\Delight\\Auth\\UnknownUsernameException $e) {\n    die('Unknown username');\n}\ncatch (\\Delight\\Auth\\AmbiguousUsernameException $e) {\n    die('Ambiguous username');\n}\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note:")," Changes to a user\u2019s set of roles may need up to five minutes to take effect. This increases performance and usually poses no problem. If you want to change this behavior, nevertheless, simply decrease (or perhaps increase) the value that you pass to the ",Object(r.b)("a",{parentName:"p",href:"#creating-a-new-instance"},Object(r.b)("inlineCode",{parentName:"a"},"Auth")," constructor")," as the argument named ",Object(r.b)("inlineCode",{parentName:"p"},"$sessionResyncInterval"),"."),Object(r.b)("h4",{id:"checking-roles-1"},"Checking roles"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    if ($auth->admin()->doesUserHaveRole($userId, \\Delight\\Auth\\Role::ADMIN)) {\n        echo 'The specified user is an administrator';\n    }\n    else {\n        echo 'The specified user is not an administrator';\n    }\n}\ncatch (\\Delight\\Auth\\UnknownIdException $e) {\n    die('Unknown user ID');\n}\n")),Object(r.b)("p",null,"Alternatively, you can get a list of all the roles that have been assigned to the user:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$auth->admin()->getRolesForUserById($userId);\n")),Object(r.b)("h4",{id:"impersonating-users-logging-in-as-user"},"Impersonating users (logging in as user)"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->admin()->logInAsUserById($_POST['id']);\n}\ncatch (\\Delight\\Auth\\UnknownIdException $e) {\n    die('Unknown ID');\n}\ncatch (\\Delight\\Auth\\EmailNotVerifiedException $e) {\n    die('Email address not verified');\n}\n\n// or\n\ntry {\n    $auth->admin()->logInAsUserByEmail($_POST['email']);\n}\ncatch (\\Delight\\Auth\\InvalidEmailException $e) {\n    die('Unknown email address');\n}\ncatch (\\Delight\\Auth\\EmailNotVerifiedException $e) {\n    die('Email address not verified');\n}\n\n// or\n\ntry {\n    $auth->admin()->logInAsUserByUsername($_POST['username']);\n}\ncatch (\\Delight\\Auth\\UnknownUsernameException $e) {\n    die('Unknown username');\n}\ncatch (\\Delight\\Auth\\AmbiguousUsernameException $e) {\n    die('Ambiguous username');\n}\ncatch (\\Delight\\Auth\\EmailNotVerifiedException $e) {\n    die('Email address not verified');\n}\n")),Object(r.b)("h4",{id:"changing-a-users-password"},"Changing a user\u2019s password"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"try {\n    $auth->admin()->changePasswordForUserById($_POST['id'], $_POST['newPassword']);\n}\ncatch (\\Delight\\Auth\\UnknownIdException $e) {\n    die('Unknown ID');\n}\ncatch (\\Delight\\Auth\\InvalidPasswordException $e) {\n    die('Invalid password');\n}\n\n// or\n\ntry {\n    $auth->admin()->changePasswordForUserByUsername($_POST['username'], $_POST['newPassword']);\n}\ncatch (\\Delight\\Auth\\UnknownUsernameException $e) {\n    die('Unknown username');\n}\ncatch (\\Delight\\Auth\\AmbiguousUsernameException $e) {\n    die('Ambiguous username');\n}\ncatch (\\Delight\\Auth\\InvalidPasswordException $e) {\n    die('Invalid password');\n}\n")),Object(r.b)("h3",{id:"cookies"},"Cookies"),Object(r.b)("p",null,"This library uses two cookies to keep state on the client: The first, whose name you can retrieve using"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\session_name();\n")),Object(r.b)("p",null,"is the general (mandatory) session cookie. The second (optional) cookie is only used for ",Object(r.b)("a",{parentName:"p",href:"#keeping-the-user-logged-in"},"persistent logins")," and its name can be retrieved as follows:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\Delight\\Auth\\Auth::createRememberCookieName();\n")),Object(r.b)("h4",{id:"renaming-the-librarys-cookies"},"Renaming the library\u2019s cookies"),Object(r.b)("p",null,"You can rename the session cookie used by this library through one of the following means, in order of recommendation:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"In the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),"), find the line with the ",Object(r.b)("inlineCode",{parentName:"p"},"session.name")," directive and change its value to something like ",Object(r.b)("inlineCode",{parentName:"p"},"session_v1"),", as in:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre"},"session.name = session_v1\n"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"As early as possible in your application, and before you create the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth")," instance, call ",Object(r.b)("inlineCode",{parentName:"p"},"\\ini_set")," to change ",Object(r.b)("inlineCode",{parentName:"p"},"session.name")," to something like ",Object(r.b)("inlineCode",{parentName:"p"},"session_v1"),", as in:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\ini_set('session.name', 'session_v1');\n")),Object(r.b)("p",{parentName:"li"}," For this to work, ",Object(r.b)("inlineCode",{parentName:"p"},"session.auto_start")," must be set to ",Object(r.b)("inlineCode",{parentName:"p"},"0")," in the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),").")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"As early as possible in your application, and before you create the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth")," instance, call ",Object(r.b)("inlineCode",{parentName:"p"},"\\session_name")," with an argument like ",Object(r.b)("inlineCode",{parentName:"p"},"session_v1"),", as in:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\session_name('session_v1');\n")),Object(r.b)("p",{parentName:"li"}," For this to work, ",Object(r.b)("inlineCode",{parentName:"p"},"session.auto_start")," must be set to ",Object(r.b)("inlineCode",{parentName:"p"},"0")," in the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),")."))),Object(r.b)("p",null,"The name of the cookie for ",Object(r.b)("a",{parentName:"p",href:"#keeping-the-user-logged-in"},"persistent logins")," will change as well \u2013 automatically \u2013 following your change of the session cookie\u2019s name."),Object(r.b)("h4",{id:"defining-the-domain-scope-for-cookies"},"Defining the domain scope for cookies"),Object(r.b)("p",null,"A cookie\u2019s ",Object(r.b)("inlineCode",{parentName:"p"},"domain")," attribute controls which domain (and which subdomains) the cookie will be valid for, and thus where the user\u2019s session and authentication state will be available."),Object(r.b)("p",null,"The recommended default is an empty string, which means that the cookie will only be valid for the ",Object(r.b)("em",{parentName:"p"},"exact")," current host, ",Object(r.b)("em",{parentName:"p"},"excluding")," any subdomains that may exist. You should only use a different value if you need to share cookies between different subdomains. Often, you\u2019ll want to share cookies between the bare domain and the ",Object(r.b)("inlineCode",{parentName:"p"},"www")," subdomain, but you might also want to share them between any other set of subdomains."),Object(r.b)("p",null,"Whatever set of subdomains you choose, you should set the cookie\u2019s attribute to the ",Object(r.b)("em",{parentName:"p"},"most specific")," domain name that still includes all your required subdomains. For example, to share cookies between ",Object(r.b)("inlineCode",{parentName:"p"},"example.com")," and ",Object(r.b)("inlineCode",{parentName:"p"},"www.example.com"),", you would set the attribute to ",Object(r.b)("inlineCode",{parentName:"p"},"example.com"),". But if you wanted to share cookies between ",Object(r.b)("inlineCode",{parentName:"p"},"sub1.app.example.com")," and ",Object(r.b)("inlineCode",{parentName:"p"},"sub2.app.example.com"),", you should set the attribute to ",Object(r.b)("inlineCode",{parentName:"p"},"app.example.com"),". Any explicitly specified domain name will always ",Object(r.b)("em",{parentName:"p"},"include")," all subdomains that may exist."),Object(r.b)("p",null,"You can change the attribute through one of the following means, in order of recommendation:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"In the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),"), find the line with the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_domain")," directive and change its value as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre"},"session.cookie_domain = example.com\n"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"As early as possible in your application, and before you create the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth")," instance, call ",Object(r.b)("inlineCode",{parentName:"p"},"\\ini_set")," to change the value of the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_domain")," directive as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\ini_set('session.cookie_domain', 'example.com');\n")),Object(r.b)("p",{parentName:"li"}," For this to work, ",Object(r.b)("inlineCode",{parentName:"p"},"session.auto_start")," must be set to ",Object(r.b)("inlineCode",{parentName:"p"},"0")," in the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),")."))),Object(r.b)("h4",{id:"restricting-the-path-where-cookies-are-available"},"Restricting the path where cookies are available"),Object(r.b)("p",null,"A cookie\u2019s ",Object(r.b)("inlineCode",{parentName:"p"},"path")," attribute controls which directories (and subdirectories) the cookie will be valid for, and thus where the user\u2019s session and authentication state will be available."),Object(r.b)("p",null,"In most cases, you\u2019ll want to make cookies available for all paths, i.e. any directory and file, starting in the root directory. That is what a value of ",Object(r.b)("inlineCode",{parentName:"p"},"/")," for the attribute does, which is also the recommended default. You should only change this attribute to a different value, e.g. ",Object(r.b)("inlineCode",{parentName:"p"},"/path/to/subfolder"),", if you want to restrict which directories your cookies will be available in, e.g. to host multiple applications side-by-side, in different directories, under the same domain name."),Object(r.b)("p",null,"You can change the attribute through one of the following means, in order of recommendation:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"In the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),"), find the line with the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_path")," directive and change its value as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre"},"session.cookie_path = /\n"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"As early as possible in your application, and before you create the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth")," instance, call ",Object(r.b)("inlineCode",{parentName:"p"},"\\ini_set")," to change the value of the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_path")," directive as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\ini_set('session.cookie_path', '/');\n")),Object(r.b)("p",{parentName:"li"}," For this to work, ",Object(r.b)("inlineCode",{parentName:"p"},"session.auto_start")," must be set to ",Object(r.b)("inlineCode",{parentName:"p"},"0")," in the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),")."))),Object(r.b)("h4",{id:"controlling-client-side-script-access-to-cookies"},"Controlling client-side script access to cookies"),Object(r.b)("p",null,"Using the ",Object(r.b)("inlineCode",{parentName:"p"},"httponly")," attribute, you can control whether client-side scripts, i.e. JavaScript, should be able to access your cookies or not. For security reasons, it is best to ",Object(r.b)("em",{parentName:"p"},"deny")," script access to your cookies, which reduces the damage that successful XSS attacks against your application could do, for example."),Object(r.b)("p",null,"Thus, you should always set ",Object(r.b)("inlineCode",{parentName:"p"},"httponly")," to ",Object(r.b)("inlineCode",{parentName:"p"},"1"),", except for the rare cases where you really need access to your cookies from JavaScript and can\u2019t find any better solution. In those cases, set the attribute to ",Object(r.b)("inlineCode",{parentName:"p"},"0"),", but be aware of the consequences."),Object(r.b)("p",null,"You can change the attribute through one of the following means, in order of recommendation:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"In the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),"), find the line with the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_httponly")," directive and change its value as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre"},"session.cookie_httponly = 1\n"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"As early as possible in your application, and before you create the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth")," instance, call ",Object(r.b)("inlineCode",{parentName:"p"},"\\ini_set")," to change the value of the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_httponly")," directive as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\ini_set('session.cookie_httponly', 1);\n")),Object(r.b)("p",{parentName:"li"}," For this to work, ",Object(r.b)("inlineCode",{parentName:"p"},"session.auto_start")," must be set to ",Object(r.b)("inlineCode",{parentName:"p"},"0")," in the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),")."))),Object(r.b)("h4",{id:"configuring-transport-security-for-cookies"},"Configuring transport security for cookies"),Object(r.b)("p",null,"Using the ",Object(r.b)("inlineCode",{parentName:"p"},"secure")," attribute, you can control whether cookies should be sent over ",Object(r.b)("em",{parentName:"p"},"any")," connection, including plain HTTP, or whether a secure connection, i.e. HTTPS (with SSL/TLS), should be required. The former (less secure) mode can be chosen by setting the attribute to ",Object(r.b)("inlineCode",{parentName:"p"},"0"),", and the latter (more secure) mode can be chosen by setting the attribute to ",Object(r.b)("inlineCode",{parentName:"p"},"1"),"."),Object(r.b)("p",null,"Obviously, this solely depends on whether you are able to serve ",Object(r.b)("em",{parentName:"p"},"all")," pages exclusively via HTTPS. If you can, you should set the attribute to ",Object(r.b)("inlineCode",{parentName:"p"},"1")," and possibly combine it with HTTP redirects to the secure protocol and HTTP Strict Transport Security (HSTS). Otherwise, you may have to keep the attribute set to ",Object(r.b)("inlineCode",{parentName:"p"},"0"),"."),Object(r.b)("p",null,"You can change the attribute through one of the following means, in order of recommendation:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"In the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),"), find the line with the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_secure")," directive and change its value as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre"},"session.cookie_secure = 1\n"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"As early as possible in your application, and before you create the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth")," instance, call ",Object(r.b)("inlineCode",{parentName:"p"},"\\ini_set")," to change the value of the ",Object(r.b)("inlineCode",{parentName:"p"},"session.cookie_secure")," directive as desired, e.g.:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\ini_set('session.cookie_secure', 1);\n")),Object(r.b)("p",{parentName:"li"}," For this to work, ",Object(r.b)("inlineCode",{parentName:"p"},"session.auto_start")," must be set to ",Object(r.b)("inlineCode",{parentName:"p"},"0")," in the ",Object(r.b)("a",{parentName:"p",href:"https://www.php.net/manual/configuration.file.php"},"PHP configuration")," (",Object(r.b)("inlineCode",{parentName:"p"},"php.ini"),")."))),Object(r.b)("h3",{id:"utilities"},"Utilities"),Object(r.b)("h4",{id:"creating-a-random-string"},"Creating a random string"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$length = 24;\n$randomStr = \\Delight\\Auth\\Auth::createRandomString($length);\n")),Object(r.b)("h4",{id:"creating-a-uuid-v4-as-per-rfc-4122"},"Creating a UUID v4 as per RFC 4122"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"$uuid = \\Delight\\Auth\\Auth::createUuid();\n")),Object(r.b)("h3",{id:"reading-and-writing-session-data"},"Reading and writing session data"),Object(r.b)("p",null,"For detailed information on how to read and write session data conveniently, please refer to ",Object(r.b)("a",{parentName:"p",href:"https://github.com/delight-im/PHP-Cookie#reading-and-writing-session-data"},"the documentation of the session library"),", which is included by default."),Object(r.b)("h2",{id:"frequently-asked-questions"},"Frequently asked questions"),Object(r.b)("h3",{id:"what-about-password-hashing"},"What about password hashing?"),Object(r.b)("p",null,"Any password or authentication token is automatically hashed using the ",Object(r.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Bcrypt"},"\u201cbcrypt\u201d")," function, which is based on the ",Object(r.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Blowfish_(cipher)"},"\u201cBlowfish\u201d cipher")," and (still) considered one of the strongest password hash functions today. \u201cbcrypt\u201d is used with 1,024 iterations, i.e. a \u201ccost\u201d factor of 10. A random ",Object(r.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Salt_(cryptography)"},"\u201csalt\u201d")," is applied automatically as well."),Object(r.b)("p",null,"You can verify this configuration by looking at the hashes in your database table ",Object(r.b)("inlineCode",{parentName:"p"},"users"),". If the above is true with your setup, all password hashes in your ",Object(r.b)("inlineCode",{parentName:"p"},"users")," table should start with the prefix ",Object(r.b)("inlineCode",{parentName:"p"},"$2$10$"),", ",Object(r.b)("inlineCode",{parentName:"p"},"$2a$10$")," or ",Object(r.b)("inlineCode",{parentName:"p"},"$2y$10$"),"."),Object(r.b)("p",null,"When new algorithms (such as ",Object(r.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Argon2"},"Argon2"),") may be introduced in the future, this library will automatically take care of \u201cupgrading\u201d your existing password hashes whenever a user signs in or changes their password."),Object(r.b)("h3",{id:"how-can-i-implement-custom-password-requirements"},"How can I implement custom password requirements?"),Object(r.b)("p",null,"Enforcing a minimum length for passwords is usually a good idea. Apart from that, you may want to look up whether a potential password is in some blacklist, which you could manage in a database or in a file, in order to prevent dictionary words or commonly used passwords from being used in your application."),Object(r.b)("p",null,"To allow for maximum flexibility and ease of use, this library has been designed so that it does ",Object(r.b)("em",{parentName:"p"},"not")," contain any further checks for password requirements itself, but instead allows you to wrap your own checks around the relevant calls to library methods. Example:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"function isPasswordAllowed($password) {\n    if (\\strlen($password) < 8) {\n        return false;\n    }\n\n    $blacklist = [ 'password1', '123456', 'qwerty' ];\n\n    if (\\in_array($password, $blacklist)) {\n        return false;\n    }\n\n    return true;\n}\n\nif (isPasswordAllowed($password)) {\n    $auth->register($email, $password);\n}\n")),Object(r.b)("h3",{id:"why-are-there-problems-when-using-other-libraries-that-work-with-sessions"},"Why are there problems when using other libraries that work with sessions?"),Object(r.b)("p",null,"You might try loading this library first, and creating the ",Object(r.b)("inlineCode",{parentName:"p"},"Auth")," instance first, ",Object(r.b)("em",{parentName:"p"},"before")," loading the other libraries. Apart from that, there\u2019s probably not much we can do here."),Object(r.b)("h3",{id:"why-are-other-sites-not-able-to-frame-or-embed-my-site"},"Why are other sites not able to frame or embed my site?"),Object(r.b)("p",null,"If you want to let others include your site in a ",Object(r.b)("inlineCode",{parentName:"p"},"<frame>"),", ",Object(r.b)("inlineCode",{parentName:"p"},"<iframe>"),", ",Object(r.b)("inlineCode",{parentName:"p"},"<object>"),", ",Object(r.b)("inlineCode",{parentName:"p"},"<embed>")," or ",Object(r.b)("inlineCode",{parentName:"p"},"<applet>")," element, you have to disable the default clickjacking prevention:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\\header_remove('X-Frame-Options');\n")),Object(r.b)("h2",{id:"exceptions"},"Exceptions"),Object(r.b)("p",null,"This library throws two types of exceptions to indicate problems:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"AuthException")," and its subclasses are thrown whenever a method does not complete successfully. You should ",Object(r.b)("em",{parentName:"li"},"always")," catch these exceptions as they carry the normal error responses that you must react to."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"AuthError")," and its subclasses are thrown whenever there is an internal problem or the library has not been installed correctly. You should ",Object(r.b)("em",{parentName:"li"},"not")," catch these exceptions.")),Object(r.b)("h2",{id:"general-advice"},"General advice"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Serve ",Object(r.b)("em",{parentName:"li"},"all")," pages over HTTPS only, i.e. using SSL/TLS for every single request."),Object(r.b)("li",{parentName:"ul"},"You should enforce a minimum length for passwords, e.g. 10 characters, but ",Object(r.b)("em",{parentName:"li"},"never")," any maximum length, at least not anywhere below 100 characters. Moreover, you should ",Object(r.b)("em",{parentName:"li"},"not")," restrict the set of allowed characters."),Object(r.b)("li",{parentName:"ul"},"Whenever a user was remembered through the \u201cremember me\u201d feature enabled or disabled during sign in, which means that they did not log in by typing their password, you should require re-authentication for critical features."),Object(r.b)("li",{parentName:"ul"},"Encourage users to use pass",Object(r.b)("em",{parentName:"li"},"phrases"),", i.e. combinations of words or even full sentences, instead of single pass",Object(r.b)("em",{parentName:"li"},"words"),"."),Object(r.b)("li",{parentName:"ul"},"Do not prevent users' password managers from working correctly. Thus, use the standard form fields only and do not prevent copy and paste."),Object(r.b)("li",{parentName:"ul"},"Before executing sensitive account operations (e.g. changing a user\u2019s email address, deleting a user\u2019s account), you should always require re-authentication, i.e. require the user to verify their login credentials once more."),Object(r.b)("li",{parentName:"ul"},"You should not offer an online password reset feature (\u201cforgot password\u201d) for high-security applications."),Object(r.b)("li",{parentName:"ul"},"For high-security applications, you should not use email addresses as identifiers. Instead, choose identifiers that are specific to the application and secret, e.g. an internal customer number.")))}p.isMDXComponent=!0}}]);